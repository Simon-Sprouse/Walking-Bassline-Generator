@page "/"
@using BlazorWalkingBassline.Models
@using BlazorWalkingBassline.MusicTheory

<PageTitle>Walking Basslines</PageTitle>

<h1>Walking Bassline Generator</h1>

<h2>Chords in Progression</h2>
@foreach (var chord in progression.Chords) 
{ 
    <p>@chord.ToString()</p>
}

<h2>Generated Chord Notes (Midi Number)</h2>
@foreach (var pair in chordNotesList)
{
    <p>@pair.chord: @string.Join(", ", pair.notes)</p>
}

<h2>Generated Chord Names (Midi Number)</h2>
@foreach (var pair in chordNotesList)
{
    <p>@pair.chord: @string.Join(", ", pair.notes.Select(m => generator.NoteFromMidi(m)))</p>
}

<h2>ASCII Bass Tab Prototype</h2>

<pre>@TabFormatter.RenderTextTab(tabNotes)</pre>

@code {

    private Progression progression;
    private Generator generator;
    private List<(Chord chord, List<int> notes)> chordNotesList;

    private List<TabNote> tabNotes;

    protected override void OnInitialized()
    {
        // Initialize progression
        progression = new Progression(
            "C",
            new List<Chord>
            {
                new Chord(ScaleDegree.One),
                new Chord(ScaleDegree.Five),
                new Chord(ScaleDegree.Two),
                new Chord(ScaleDegree.Four)
            }
        );

        // Initialize generator
        generator = new Generator(progression);

        // Generate chord notes
        chordNotesList = generator.GenerateChordNotes();



        tabNotes = new List<TabNote>
        {
            new TabNote(3, 3, 1), // A string, fret 3
            new TabNote(2, 5, 2), // D string, fret 5
            new TabNote(2, 3, 3), // D string, fret 3
            new TabNote(3, 11, 4)  // A string, fret 5
        };
    }


    

    
}
